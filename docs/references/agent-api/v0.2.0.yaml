openapi: 3.0.3
info:
  title: Miru Agent API
  description: The API between the Miru Agent and any external client living on the
    same device as the Miru Agent
  version: v0.1.0-next
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  x-git-commit:
    sha: 598b13eecca0a1c95437096f8d72af66aa7338f3
    url: https://github.com/mirurobotics/openapi/commit/598b13eecca0a1c95437096f8d72af66aa7338f3
    message: 'feat(schema): add API version enum to MiruVersion header parameter


      Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>'
    author: Benjamin Smidt
    branch: main
    dirty: false
  x-build:
    built_at: '2026-03-01T22:34:34.321215+00:00'
servers:
- url: http://localhost/v0.2
  description: localhost
security: []
paths:
  /health:
    get:
      tags:
      - Agent
      summary: Health
      description: Retrieve the health of the agent.
      operationId: health
      responses:
        '200':
          description: Successfully retrieved the health of the agent.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /version:
    get:
      tags:
      - Agent
      summary: Version
      description: Retrieve the version of the agent.
      operationId: version
      responses:
        '200':
          description: Successfully retrieved the version of the agent.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VersionResponse'
  /deployments/{deployment_id}:
    get:
      tags:
      - Deployments
      summary: Get
      operationId: getDeployment
      description: Retrieve a deployment by its ID.
      parameters:
      - $ref: '#/components/parameters/deployment_id'
      responses:
        '200':
          description: Successfully retrieved the deployment.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Deployment'
  /deployments/current:
    get:
      tags:
      - Deployments
      summary: Get Current
      operationId: getCurrentDeployment
      description: Get the current deployment for the device.
      responses:
        '200':
          description: Successfully retrieved the current deployment.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Deployment'
  /device:
    get:
      tags:
      - Device
      summary: Get
      description: Retrieve the device.
      operationId: getDevice
      responses:
        '200':
          description: Successfully retrieved the device.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Device'
  /device/sync:
    post:
      tags:
      - Device
      summary: Sync
      description: Manually force a device sync with the edits made in the dashboard.
      operationId: syncDevice
      responses:
        '200':
          description: Successfully synced the device.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyncDeviceResponse'
  /git_commits/{git_commit_id}:
    get:
      tags:
      - Git Commits
      summary: Get
      description: Retrieve a git commit by its ID.
      operationId: getGitCommit
      parameters:
      - $ref: '#/components/parameters/git_commit_id'
      responses:
        '200':
          description: Successfully retrieved the git commit.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GitCommit'
  /releases/{release_id}:
    get:
      tags:
      - Releases
      summary: Get
      description: Retrieve a release by its ID.
      operationId: getRelease
      parameters:
      - $ref: '#/components/parameters/release_id'
      responses:
        '200':
          description: Successfully retrieved the release.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Release'
  /releases/current:
    get:
      tags:
      - Releases
      summary: Get Current
      description: Retrieve the current release.
      operationId: getCurrentRelease
      responses:
        '200':
          description: Successfully retrieved the current release.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Release'
components:
  schemas:
    ErrorResponse:
      type: object
      required:
      - error
      properties:
        error:
          $ref: '#/components/schemas/Error'
    APIVersion:
      type: string
      enum:
      - v0.1.0-next
      x-enum-varnames:
      - API_VERSION
      x-stainless-const: true
    APIGitCommit:
      type: string
      enum:
      - 598b13eecca0a1c95437096f8d72af66aa7338f3
      x-enum-varnames:
      - API_GIT_COMMIT
      x-stainless-const: true
    HealthResponse:
      type: object
      required:
      - status
      properties:
        status:
          type: string
          description: The status of the agent.
          example: ok
    VersionResponse:
      type: object
      required:
      - version
      - git_commit
      - api_version
      - api_git_commit
      - rust_version
      - build_date
      - os
      - arch
      properties:
        version:
          type: string
          description: The version of the agent.
          example: v1.0.0
        git_commit:
          type: string
          description: The git commit of the agent.
          example: a1b2c3d4
        api_version:
          type: string
          description: The API version of the agent.
          example: v1-0
        api_git_commit:
          type: string
          description: The git commit of the API.
          example: a1b2c3d4
        rust_version:
          type: string
          description: The version of Rust.
          example: 1.93.0
        build_date:
          type: string
          format: date-time
          description: The build date of the agent.
          example: '2026-02-24T10:30:00Z'
        os:
          type: string
          description: The operating system of the agent.
          example: linux
        arch:
          type: string
          description: The architecture of the agent.
          example: aarch64
    DeploymentStatus:
      type: string
      description: 'This status merges the ''activity_status'' and ''error_status''
        fields, with error states taking precedence over activity states when errors
        are present. For example, if the activity status is ''deployed'' but the error
        status is ''failed'', the status is ''failed''. However, if the error status
        is ''none'' and the activity status is ''deployed'', the status is ''deployed''.

        '
      enum:
      - drifted
      - staged
      - queued
      - deployed
      - archived
      - failed
      - retrying
      x-enum-varnames:
      - DEPLOYMENT_STATUS_DRIFTED
      - DEPLOYMENT_STATUS_STAGED
      - DEPLOYMENT_STATUS_QUEUED
      - DEPLOYMENT_STATUS_DEPLOYED
      - DEPLOYMENT_STATUS_ARCHIVED
      - DEPLOYMENT_STATUS_FAILED
      - DEPLOYMENT_STATUS_RETRYING
    DeploymentActivityStatus:
      type: string
      description: 'Last known activity state of the deployment.

        - Drifted: device''s configurations have drifted since this deployment was
        staged, and the deployment needs to be reviewed before it can be deployed

        - Staged: is ready to be deployed

        - Queued: the deployment''s config instances are waiting to be received by
        the device; will be deployed as soon as the device is online

        - Deployed: the deployment''s config instances are currently available for
        consumption on the device

        - Archived: the deployment is available for historical reference but cannot
        be deployed and is not active on the device

        '
      enum:
      - drifted
      - staged
      - queued
      - deployed
      - archived
      x-enum-varnames:
      - DEPLOYMENT_ACTIVITY_STATUS_DRIFTED
      - DEPLOYMENT_ACTIVITY_STATUS_STAGED
      - DEPLOYMENT_ACTIVITY_STATUS_QUEUED
      - DEPLOYMENT_ACTIVITY_STATUS_DEPLOYED
      - DEPLOYMENT_ACTIVITY_STATUS_ARCHIVED
    DeploymentErrorStatus:
      type: string
      description: 'Last known error state of the deployment.

        - None: no errors

        - Retrying: an error has been encountered and the agent is retrying to reach
        the target status

        - Failed: a fatal error has been encountered; the deployment is archived and
        (if deployed) removed from the device

        '
      enum:
      - none
      - failed
      - retrying
      x-enum-varnames:
      - DEPLOYMENT_ERROR_STATUS_NONE
      - DEPLOYMENT_ERROR_STATUS_FAILED
      - DEPLOYMENT_ERROR_STATUS_RETRYING
    DeploymentTargetStatus:
      type: string
      description: 'Desired state of the deployment.

        - Staged: is ready to be deployed

        - Deployed: all config instances part of the deployment are available for
        consumption on the device

        - Archived: the deployment is available for historical reference but cannot
        be deployed and is not active on the device

        '
      enum:
      - staged
      - deployed
      - archived
      x-enum-varnames:
      - DEPLOYMENT_TARGET_STATUS_STAGED
      - DEPLOYMENT_TARGET_STATUS_DEPLOYED
      - DEPLOYMENT_TARGET_STATUS_ARCHIVED
    BaseDeployment:
      title: Base Deployment
      type: object
      required:
      - object
      - id
      - description
      - status
      - activity_status
      - error_status
      - target_status
      - device_id
      - release_id
      - created_at
      - updated_at
      properties:
        object:
          type: string
          enum:
          - deployment
          example: deployment
          x-stainless-const: true
          description: The object type, which is always `deployment`.
        id:
          type: string
          example: dpl_123
          description: ID of the deployment.
        description:
          type: string
          example: Deployment for the motion control config instance
          description: The description of the deployment.
        status:
          $ref: '#/components/schemas/DeploymentStatus'
        activity_status:
          $ref: '#/components/schemas/DeploymentActivityStatus'
        error_status:
          $ref: '#/components/schemas/DeploymentErrorStatus'
        target_status:
          $ref: '#/components/schemas/DeploymentTargetStatus'
        device_id:
          type: string
          example: dvc_123
          description: ID of the device.
        release_id:
          type: string
          example: rls_123
          description: ID of the release.
        created_at:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
          description: Timestamp of when the device release was created.
        updated_at:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
          description: Timestamp of when the device release was last updated.
    BaseConfigInstance:
      title: Base Config Instance
      type: object
      required:
      - object
      - id
      - config_type_name
      - filepath
      - created_at
      - config_schema_id
      - config_type_id
      properties:
        object:
          type: string
          enum:
          - config_instance
          example: config_instance
          x-stainless-const: true
          description: The object type, which is always `config_instance`.
        id:
          type: string
          example: cfg_inst_123
          description: ID of the config instance.
        config_type_name:
          type: string
          example: Motion Control
          description: The name of the config type.
        filepath:
          type: string
          example: /v1/motion-control.json
          description: The file path to deploy the config instance relative to `/srv/miru/config_instances`.
            `v1/motion-control.json` would deploy to `/srv/miru/config_instances/v1/motion-control.json`.
        created_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: The timestamp of when the config instance was created.
        config_schema_id:
          type: string
          example: cfg_sch_123
          description: ID of the config schema which the config instance must adhere
            to.
        config_type_id:
          type: string
          example: cfg_type_123
          description: ID of the config type which the config instance (and its schema)
            is a part of.
    InstanceFormat:
      title: Instance Format
      type: string
      enum:
      - json
      x-enum-varnames:
      - INSTANCE_FORMAT_JSON
    InstanceContent:
      title: Instance Content
      type: object
      required:
      - format
      - data
      properties:
        format:
          $ref: '#/components/schemas/InstanceFormat'
        data:
          type: string
          description: The configuration values associated with the config instance.
          example: "{\n  \"enable_autonomy\": true,\n  \"enable_remote_control\":\
            \ true,\n  \"max_payload_kg\": 10.0\n}\n"
    ConfigInstance:
      allOf:
      - $ref: '#/components/schemas/BaseConfigInstance'
      - type: object
        required:
        - content
        properties:
          content:
            allOf:
            - $ref: '#/components/schemas/InstanceContent'
            description: The configuration values associated with the config instance.
    Deployment:
      allOf:
      - $ref: '#/components/schemas/BaseDeployment'
      - type: object
        properties:
          config_instances:
            type: array
            items:
              $ref: '#/components/schemas/ConfigInstance'
            description: The config instances associated with this deployment.
      example:
        object: deployment
        id: dpl_123
        description: Deployment for the motion control config instance
        status: staged
        activity_status: staged
        error_status: none
        target_status: staged
        device_id: dvc_123
        release_id: rls_123
        created_at: '2024-01-01T00:00:00Z'
        updated_at: '2024-01-01T00:00:00Z'
    DeviceStatus:
      type: string
      description: 'The status of the device.

        - Online: The miru agent is connected

        - Offline: The miru agent is disconnected (e.g. network issues, device is
        powered off, etc.)

        '
      enum:
      - online
      - offline
      x-enum-varnames:
      - DEVICE_STATUS_ONLINE
      - DEVICE_STATUS_OFFLINE
    Device:
      title: Device
      type: object
      required:
      - object
      - id
      - name
      - status
      - last_synced_at
      - last_connected_at
      - last_disconnected_at
      properties:
        object:
          type: string
          enum:
          - device
          example: device
          x-stainless-const: true
          description: The object type, which is always `device`.
        id:
          type: string
          example: dvc_123
          description: ID of the device.
        name:
          type: string
          example: My Device
          description: Name of the device.
        status:
          $ref: '#/components/schemas/DeviceStatus'
        last_synced_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of when the device was last synced.
        last_connected_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of the last successful connection event with the
            backend.
        last_disconnected_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of the last successful disconnection event with the
            backend.
    SyncDeviceResult:
      type: string
      description: The result of attempting to sync the device.
      enum:
      - success
      - network_connection_error
      - in_cooldown
      x-enum-varnames:
      - SYNC_DEVICE_RESULT_SUCCESS
      - SYNC_DEVICE_RESULT_NETWORK_CONNECTION_ERROR
      - SYNC_DEVICE_RESULT_IN_COOLDOWN
    SyncDeviceResponse:
      title: Sync Device Response
      type: object
      required:
      - code
      - message
      - last_synced_at
      - last_attempted_sync_at
      - in_cooldown
      - cooldown_ends_at
      properties:
        code:
          $ref: '#/components/schemas/SyncDeviceResult'
        message:
          type: string
          example: Device is not connected to the backend.
          description: The message of the result.
        last_synced_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of when the device was last synced.
        last_attempted_sync_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of when the last *attempted* sync occurred.
        in_cooldown:
          type: boolean
          example: true
          description: Whether the device is currently in cooldown.
        cooldown_ends_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of when the cooldown will end.
    GitCommit:
      title: Git Commit
      type: object
      required:
      - object
      - id
      - sha
      - message
      - commit_url
      - created_at
      properties:
        object:
          type: string
          enum:
          - git_commit
          example: git_commit
          x-stainless-const: true
          description: The object type, which is always `git_commit`.
        id:
          type: string
          example: git_commit_123
          description: ID of the git commit.
        sha:
          type: string
          example: a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0
          description: The SHA hash of the git commit.
        message:
          type: string
          example: Add basic motion configurations
          description: The commit message.
        commit_url:
          type: string
          example: https://github.com/user/repo/commit/a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0
          description: The URL of the git commit.
        created_at:
          type: string
          format: date-time
          example: '2021-01-01T00:00:00Z'
          description: Timestamp of when the git commit was created.
    BaseRelease:
      title: Base Release
      type: object
      required:
      - object
      - id
      - version
      - git_commit_id
      - created_at
      - updated_at
      properties:
        object:
          type: string
          enum:
          - release
          example: release
          x-stainless-const: true
          description: The object type, which is always `release`.
        id:
          type: string
          example: rls_123
          description: ID of the release.
        version:
          type: string
          example: v1.0.0
          description: The version of the release.
        git_commit_id:
          type: string
          nullable: true
          example: git_commit_123
          description: The ID of the git commit associated with this release.
        created_at:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
          description: Timestamp of when the release was created.
        updated_at:
          type: string
          format: date-time
          example: '2024-01-01T00:00:00Z'
          description: Timestamp of when the release was last updated.
    Release:
      allOf:
      - $ref: '#/components/schemas/BaseRelease'
    Error:
      type: object
      required:
      - code
      - params
      - message
      properties:
        code:
          type: string
          example: invalid_request
          description: The error code identifying the type of error.
        params:
          type: object
          additionalProperties: true
          example:
            param1: value1
            param2: value2
          description: Additional parameters providing context about the error.
        message:
          type: string
          example: This is a message for a user
          description: A human-readable message describing the error.
  parameters:
    deployment_id:
      name: deployment_id
      in: path
      required: true
      description: The unique identifier of the deployment.
      schema:
        type: string
        example: dpl_123
    git_commit_id:
      name: git_commit_id
      in: path
      required: true
      description: The unique identifier of the git commit.
      schema:
        type: string
        example: git_commit_123
    release_id:
      name: release_id
      in: path
      required: true
      description: The unique identifier of the release.
      schema:
        type: string
        example: rls_123
